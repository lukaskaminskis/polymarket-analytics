{% extends "base.html" %}

{% block title %}Movers - Polymarket Analytics{% endblock %}

{% block content %}
<h1>Biggest Movers</h1>

{% if movers and movers[0].is_historical %}
<div class="alert alert-info" style="background: #e0f2fe; border: 1px solid #0ea5e9; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
    <strong>Showing all-time data.</strong> No significant moves in the last {{ window_hours }} hours.
    <br>Run <code style="background: #bae6fd; padding: 2px 6px; border-radius: 4px;">python cli.py collect</code> regularly to track recent movements.
</div>
<p class="subtitle">Markets with the largest all-time probability changes</p>
{% else %}
<p class="subtitle">Markets with the largest probability changes in the last {{ window_hours }} hours</p>
{% endif %}

<table class="data-table full-width">
    <thead>
        <tr>
            <th>Market</th>
            <th>Category</th>
            <th>Change</th>
            <th>Max Swing</th>
            <th>From</th>
            <th>To</th>
            <th>Volume</th>
        </tr>
    </thead>
    <tbody>
        {% for mover in movers %}
        <tr>
            <td>
                <a href="/market/{{ mover.market_id }}">{{ mover.question }}</a>
            </td>
            <td>{{ mover.category or '-' }}</td>
            <td class="change-cell {% if mover.change_points > 0 %}positive{% else %}negative{% endif %}">
                <span class="change-badge">
                    {% if mover.change_points > 0 %}+{% endif %}{{ "%.1f"|format(mover.change_points) }}pts
                </span>
            </td>
            <td>{{ "%.1f"|format(mover.max_swing) }}pts</td>
            <td>{{ "%.1f"|format(mover.probability_start) }}%</td>
            <td>{{ "%.1f"|format(mover.probability_end) }}%</td>
            <td>${{ "{:,.0f}".format(mover.volume) }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if not movers %}
<div class="empty-state">
    <p>No significant moves detected yet.</p>
    <p>Run data collection to start tracking markets.</p>
</div>
{% endif %}
{% endblock %}
